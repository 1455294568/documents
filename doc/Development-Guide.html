<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<link type="text/css" rel="stylesheet" href="bootstrap.min.css" />
<title>Development Guide</title>
</head>

<body>

<p><strong>IMPORTANT: THIS DOCUMENT IS BEING WRITTEN AND NOT COMPLETED YET.</strong></p>

<ul>
	<li>Introduction</li>
	<li>Overall solution structure</li>
	<li>Domain (business) layer<ul>
		<li>Multi tenancy</li>
		<li>Roles</li>
		<li>Users</li>
		<li>Authorization</li>
		<li>Settings</li>
		<li>Emailing</li>
		<li>Base classes</li>
		<li>Versioning</li>
	</ul>
	</li>
	<li>Entity framework infrastructure</li>
	<li>Application layer</li>
	<li>Web API layer</li>
	<li>Web layer<ul>
		<li>MVC application</li>
		<li>Login &amp; register pages</li>
		<li>Backend Angular application</li>
	</ul>
	</li>
</ul>
<h3>Introduction</h3>
<p>In <a href="Getting-Started.html">Getting Started</a> document, a new sample project is created named 
"<strong>Acme.PhoneBook</strong>". This document is a guide while developing your projects.</p>
<p>Before reading this document, it's adviced to run the application and explore 
user interface. This will definetely help you to understand concepts defined here.</p>
<p>Since ASP.NET Zero is built on
<a href="http://www.aspnetboilerplate.com/" target="_blank">ASP.NET Boilerplate</a> 
application framework, this document highly refers it's documentation. Also, 
many classes in the solution extends it's base classes.</p>
<h3>Overall solution structure</h3>
<p>When you create and <a href="/Download">download</a> your project, there will be a solution structure 
as shown below:</p>
<p>
<img class="img-thumbnail" alt="ASP.NET Zero solution structure" height="166" src="images/solution-overall.png" width="249" /></p>
<p>There are 6 projects in the solution:</p>
<ul>
	<li><strong>Core</strong> project contains domain layer classes (like
	<a href="http://www.aspnetboilerplate.com/Pages/Documents/Entities">entities</a> 
	and
	<a href="http://www.aspnetboilerplate.com/Pages/Documents/Domain-Services">
	domain services</a>).</li>
	<li><strong>Application</strong> project contains application logic (<a href="http://www.aspnetboilerplate.com/Pages/Documents/Application-Services">application 
	services</a>). </li>
	<li><strong>EntityFramework</strong> project contains your DbContext,
	<a href="http://www.aspnetboilerplate.com/Pages/Documents/Repositories">
	repository</a> implementations, database migrations and other 
	EntityFramework specific concepts. </li>
	<li><strong>WebApi</strong> project contains Web API Controllers. </li>
	<li><strong>Web</strong> project contains the presentation layer 
	(javascripts, styles and views). </li>
	<li><strong>Tests </strong>project contains unit and integration tests.</li>
</ul>

<h3>Domain (business) layer</h3>
<p>PhoneBook<strong>CoreModule</strong> (YourProjectCoreModule for your project) 
class defines the core
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Module-System">module</a> 
and contains some configurations. We can enable or disable <strong>
multi-tenancy</strong> here. <strong>Email sending</strong> is disabled in DEBUG 
mode. Because, development environment may not be configured properly to send 
emails. You can enable it if you want.</p>
<h4>Multi tenancy</h4>
<p>ASP.NET Zero's all code-base is developed to be multi-tenant. But, it can be 
disabled with a single line of configuration if we're developing single-tenant 
application. You can 
<a href="Getting-Started#DocConfigureMultiTenancy">disable</a> it and skip this 
section.</p>
<p>Multi-tenancy is used to build <strong>SaaS</strong> (Software as a Service) 
applications easily. Wtih this technique, we can deploy <strong>single 
application</strong> and <strong>single database</strong> to serve to <strong>
multiple customers</strong>.</p>
<p><strong>Tenant</strong> class represents a tenant (customer). <strong>
TenantManager</strong> is used to perform domain logic for tenants. Each Tenant 
has it's own <strong>roles</strong>, <strong>users</strong> and <strong>settings</strong>.</p>
<p>ASP.NET Zero uses ABP's (ASP.NET Boilerplate)
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Data-Filters">data 
filters</a>. So, it automatically filters tenant datas if you properly use 
filter interfaces. Read data filters
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Data-Filters">
documentation</a> carefully if you are building multi-tenant applications.</p>

<h4>Roles</h4>

<p>A role is represented by the <strong>Role</strong> class. Roles are used to <strong>group permissions</strong>. When a user has a role, 
then he/she will have all permissions of that role. Roles can be 
dynamic or static:</p>

<ul>
	<li><strong>Static role</strong>: A static role has a known <strong>name
	</strong>(like 'admin') and can not change this name (we can change <strong>
	display name</strong>). It's exists on the system startup and can not be 
	deleted. Thus, we can write codes based on a static role name.</li>
	<li><strong>Dynamic role</strong>: We can create a dynamic role 
	after deployment. Then we can grant permissions for that role, we can assign 
	the role to some users and we can delete it. We can not know names of 
	dynamic roles in development time.</li>
</ul>

<p>One or more roles can be set as <strong>default</strong>. Default roles are 
assigned to new added/registered users as default. This is not a development 
time property and can be set or changed after deployment.</p>

<p>In startup project, we have static <strong>admin </strong>role for host (for 
multi-tenant apps). Also, we have static <strong>admin </strong>and <strong>user </strong>
roles for tenants. <strong>Admin </strong>roles have all permissions granted by 
default. <strong>User </strong>role is the <strong>default</strong> role for new users and has no 
permission by default. These can be changed easily. See <strong>StaticRoleNames</strong> class for 
all static roles and <strong>AppRoleConfig</strong> for adding static roles to 
the system.</p>
<p><strong>RoleManager</strong> class is used to perform domain logic for roles.</p>
<h4>Users</h4>
<p><strong>User</strong> class represents a user. <strong>UserManager</strong> 
is used to perform domain logic for users.</p>

<p>Users are people who can <strong>login </strong>to the application and 
perform some operations based on their <strong>permissions</strong>.</p>
<p>A user can have zero or more <strong>roles</strong>. A user inherits union of 
permissions of his all roles. Also, we can set <strong>user-specific permission</strong>. 
A user specific permission setting overrides role settings for this permission.</p>
<h4>Settings</h4>
<p>ABP's
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Setting-Management">
setting system</a> is used to store and get application settings. Settings and 
default values are defined in <strong>AppSettingProvider</strong> class.</p>
<h4>Emailing</h4>
<p>ASP.NET Zero sends emails to users in some cases (like forgot password and 
email confirmation). Email template is defined in <strong>Emailing</strong> 
namespace.</p>
<h4>Localization</h4>
<p>ASP.NET Zero UI is completely
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Localization">
localized</a>. Localization is implemented using XML files. English and Turkish 
localization is ready. You can add more XML files by copying one XML file and 
translate to desired language. </p>
<h4>Base classes</h4>
<p>There are some useful base classes thos can be inherited to make things 
easier:</p>
<ul>
	<li>PhoneBook<strong>DomainServiceBase</strong> can be used as a base class 
	for domain services.</li>
	<li>PhoneBook<strong>ServiceBase</strong> can be used as a base class for 
	other service-like classes.</li>
</ul>
<h4>Versioning</h4>
<p><strong>AppVersionHelper</strong> class is used to define version of the 
application in single place. When you change <strong>Version</strong> here, all 
projects in the application will be verisoned. Also, version and release date 
automatically shown on UI.</p>
<h3>Entity framework infrastructure</h3>
<p>ASP.NET Zero template uses EntityFramework code-first and migrations.</p>
<p>PhoneBook<strong>DbContext</strong> (YourProjectDbContext for your project) 
defines the DbContext class. Migrations folder contains EF migrations. </p>
<p>PhoneBook<strong>RepositoryBase</strong> class is the base class for your
<a href="http://www.aspnetboilerplate.com/Pages/Documents/EntityFramework-Integration#DocCustomRepositoryMethods">
custom repositories</a>.</p>
<h3>Application layer</h3>
<p>Application Layer contains 
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Application-Services">application services</a> 
those are used by the Presentation Layer. 
An application service method receives a DTO (Data Transfer Object) as input, 
uses this input to perform some specific business operation, and may return another DTO, if needed.</p>
<h4>Authorization</h4>
<p>ABP's authorization system is based on permissions. <strong>
AppAuthorizationProvider</strong> class defines all permissions in the system.</p>
<h4>Application services</h4>
<p>Application layer has following application services:</p>
<ul>
	<li><strong>TenantAppService</strong>: Contains service methods for tenant 
	management page.</li>
	<li><strong>UserAppService</strong>: Contains service methods for user 
	management page.</li>
	<li><strong>RoleAppService</strong>: Contains service methods for role 
	management page.</li>
	<li><strong>SessionAppService</strong>: Contains service method to get 
	current session informations.</li>
	<li><strong>TenantSettingsAppService</strong>: Contains service methods for 
	tenant settings page.</li>
	<li><strong>HostSettingsAppService</strong>: Contains service methods for 
	host settings page.</li>
	<li><strong>ProfileAppService</strong>: Used to get/change user profile 
	informations and password.</li>
	<li><strong>TenantDashboardAppService</strong>: Example application service 
	for dashboard.</li>
</ul>
<p>Every application service defines an interface (like IUserAppService) and an 
implementation (like UserAppService class). DTOs are defined in Dto namespaces.</p>
<h3>Web API layer</h3>
<p>Since application is built on AngularJs and it's a Single-Page Application 
(SPA), application services are used via AJAX. So, it's needed to create web API 
controllers as adapter. ABP framework automatically creates
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Dynamic-Web-API">
dynamic web API layer</a> using application service interface definitions. So, 
there is no web API Controller actually. We build dynamic web api controllers in 
PhoneBook<strong>WebApiModule</strong> class.</p>
<h3>Web layer</h3>
<h4>Folder structure</h4>
<ul>
	<li><strong>Abp</strong>: ASP.NET Boilerplate's script files. Comes with
	<a href="http://www.nuget.org/packages/Abp.Web.Resources">Abp.Web.Resources</a> 
	nuget package.</li>
	<li><strong>App</strong>: Contains the AngularJs backend application files.</li>
	<li><strong>App_Start</strong>: Contains web module definition, Owin startup 
	file, bundling, navigation and routing configurations.</li>
	<li><strong>Bundles</strong>: ASP.NET bundling fails to find some resources. 
	They are located here.</li>
	<li><strong>Common</strong>: Contains core script and style files can be 
	used by all pages.</li>
	<li><strong>Content</strong>: Contains files come with some nuget packages.</li>
	<li><strong>Controllers</strong>: Contains ASP.NET MVC Controllers.</li>
	<li><strong>fonts</strong>: Contains some fonts used in application.</li>
	<li><strong>libs</strong>: Contains javascript &amp; css libraries thos are not 
	installed by Nuget.</li>
	<li><strong>metronic</strong>: Contains metronic resources. Since total size 
	of all metronic files are too big, this folder contains needed resources for 
	the application. You can add other resources if you need later.</li>
	<li><strong>Models</strong>: Contains MVC Model classes.</li>
	<li><strong>Scripts</strong>: Contains script files of Nuget packages.</li>
	<li><strong>Views</strong>: Contains razor views.</li>
</ul>
<h4>Used libraries</h4>
<p>There are many javascript libraries used in the web application. Most of them 
are located in <strong>libs</strong> folder. Some of them are installed using 
Nuget and located in <strong>Scripts</strong> folder. Also, <strong>Abp</strong> 
foler contains ASP.NET Boilerplate's script files.</p>
<h4>Bundling &amp; Minifying</h4>
<p>ASP.NET Zero uses
<a href="https://www.nuget.org/packages/Microsoft.AspNet.Web.Optimization" target="_blank">
ASP.NET Optimization</a> for bundling &amp; minifying script and style files. All 
bundles are defined in <strong>BundleConfig</strong> class.</p>
<h4>Logger configuration</h4>
<p>ASP.NET Zero uses Log4Net for
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Logging">logging</a> 
as default. Configuration is defined in log4net.config file. It writes all logs 
into <strong>Logs</strong> folder of web site as default. When you publish your 
project, remember to configure write permission to Logs folder.</p>
<h4>MVC application</h4>
<p>ASP.NET Zero contains front-end pages that can be a starting point for your 
public web site. It has only <strong>Home</strong> and <strong>About</strong> 
pages but you can dd as many pages as you need.</p>
<p>HomeController, AboutController and LayoutController controllers are related 
to front-end MVC pages. Views/Layout folder contains front-end layout views.</p>
<h4>Login &amp; register pages</h4>
<p><strong>AccountController</strong> is the main MVC controller class that is 
used by login, register, forgot password and email activation pages. It has own
<strong>layout</strong>. All views are located in Views/Account folder.</p>
<h4>Backend Angular application</h4>
<p>Users must login in order to enter application pages. Root controller is the
<strong>ApplicationController</strong> class here. It gets application's <strong>
layout</strong> page to start the system.</p>
<p>All view, script and styles files are located in <strong>App</strong> folder:</p>
<p>
<img class="img-thumbnail" alt="Angular App folder structure" height="413" src="images/app-folders.png" width="152" /></p>
<p>There are three main folders here:</p>
<ul>
	<li><strong>common</strong>: Contains common resources used by both host and 
	tenants.</li>
	<li><strong>host</strong>: Contains host-specific resources.</li>
	<li><strong>tenant</strong>: Contains tenant-specific resources.</li>
</ul>
<p>So, if we have a view, directive, service, image... used by both tenants and 
host, we should place it under common folder as shown above. While currently 
there are just views in host and tenant folders, we should place tenant or host 
specific directives, services.. under it's own folder, no to common.</p>
<p><strong>app.js</strong> is entrance point of the application. We define 
module and routes here. All scripts and styles in App folder is automatically 
bundled and added to the layout.</p>
<h4>Base controller</h4>
<p>All MVC Controllers in the application are derived from PhoneBook<strong>ControllerBase</strong> 
class. You can add common methods here.</p>
<h4>Base view</h4>
<p>All MVC Views in the application are derived from PhoneBook<strong>WebViewPageBase</strong> 
class. You can add common methods here.</p>

</body>

</html>
