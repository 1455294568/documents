<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<link type="text/css" rel="stylesheet" href="bootstrap.min.css" />
<title>Development Guide</title>
<style type="text/css">
.auto-style2 {
	font-weight: normal;
}
.auto-style3 {
	font-weight: bold;
}
</style>
</head>

<body>

<h3>Introduction</h3>

<p>In <a href="Getting-Started-Core.html">Getting Started</a> document, a new sample project is created named 
"<strong>Acme.PhoneBook</strong>". This document is a complete guide while developing your project. 
We definitely suggest to read this document before starting to the 
development. Since ASP.NET Zero is built on
<a href="http://www.aspnetboilerplate.com/" target="_blank">ASP.NET Boilerplate</a> 
application framework, this document highly refers it's 
<a href="http://www.aspnetboilerplate.com/Pages/Documents">documentation</a>.</p>
<p>Before reading this document, it's suggested to run the application and explore 
the user interface. This will help you to have a better understanding of concepts defined here.</p>
<h4>Pre Requirements</h4>
<p>Following tools are needed in order to use ASP.NET Zero Core solution:</p>
<ul>
	<li><a href="https://www.visualstudio.com">Visual Studio 2017</a>.</li>
	<li>Visual Studio Extensions:<ul>
		<li>
		<a href="https://marketplace.visualstudio.com/items?itemName=MadsKristensen.BundlerMinifier">Bundler &amp; Minifier</a></li>
		<li>
		<a href="https://marketplace.visualstudio.com/items?itemName=MadsKristensen.WebCompiler">Web Compiler</a></li>
		<li>
		<a href="https://www.microsoft.com/en-us/download/details.aspx?id=48593">
		Typescript</a> 2+</li>
	</ul>
	</li>
	<li>SQL Server</li>
</ul>
<h4>Solution Structure (Layers)</h4>
<p>After you create and <a href="/Download">download</a> your project, you have a solution structure 
as shown below:</p>
<p>
<img class="img-thumbnail" alt="Solution Structure" height="242" src="images/solution-overall-core-2.png" width="257" /></p>
<p>There are 8 projects in the solution:</p>
<ul>
	<li><strong>Core</strong> project contains domain layer classes (like
	<a href="http://www.aspnetboilerplate.com/Pages/Documents/Entities">entities</a> 
	and
	<a href="http://www.aspnetboilerplate.com/Pages/Documents/Domain-Services">
	domain services</a>).</li>
	<li><strong>Application</strong> project contains application logic (like <a href="http://www.aspnetboilerplate.com/Pages/Documents/Application-Services">application 
	services</a> and
	<a href="http://www.aspnetboilerplate.com/Pages/Documents/Data-Transfer-Objects">
	DTO</a>s). </li>
	<li><strong>EntityFramework</strong> project contains your DbContext,
	<a href="http://www.aspnetboilerplate.com/Pages/Documents/Repositories">
	repository</a> implementations, database migrations and other 
	EntityFramework specific concepts. </li>
	<li><strong>Web.Mvc</strong> project contains the presentation/API layer 
	(Controllers, Views, javascripts, styles, images and so on) for backend and 
	frontend applications.</li>
	<li><strong>Web.Host</strong> project does not contain any view/css/js 
	files. Instead, it just serves the application as remote API. So, any device 
	can consume your application as API.</li>
	<li><strong>Web.Common</strong> project contains common classes used by Mvc 
	and Host projects.</li>
	<li><strong>Migrator</strong> project is a console application that runs 
	database migrations.</li>
	<li><strong>Tests </strong>project contains unit and integration tests.</li>
</ul>

<h4>Applications</h4>
<p>ASP.NET Zero solution contains <b>t</b><span class="auto-style3">hree</span> applications:</p>
<ul>
	<li><strong>Front End Application</strong>: This can be used to 
	create a public web site or a landing page for your application.</li>
	<li><strong>Back End Application</strong>: This is the application which is 
	entered by username and password.</li>
	<li><strong>Migrator</strong>: Console application that runs database 
	migrations.</li>
</ul>
<h4>Multi tenancy</h4>
<p>Multi-tenancy is used to build <strong>SaaS</strong> (Software as a Service) 
applications easily. Wtih this technique, we can deploy <strong>single 
application</strong> to serve to <strong>
multiple customers</strong>. Each Tenant 
will have it's own <strong>roles</strong>, <strong>users</strong> and <strong>settings</strong>.</p>
<p>ASP.NET Zero's all code-base is developed to be <strong>multi-tenant</strong>. But, it 
<a href="Getting-Started#DocConfigureMultiTenancy"><strong>can be 
disabled</strong></a> with a single line of configuration if you are developing 
a 
<strong>single-tenant</strong> application. When you disable it, all multi-tenancy stuff will be 
hidden and not available. If multi-tenancy is disabled, there will be a single 
tenant named <strong>Default</strong>.</p>
<p>There are two types of perspective in multi-tenant applications:</p>
<ul>
	<li><strong>Host</strong>: Manages tenants and system.</li>
	<li><strong>Tenant</strong>: Uses the application features.</li>
</ul>
<p>ASP.NET Zero uses ABP's (ASP.NET Boilerplate)
<strong>
<a href="http://aspnetboilerplate.com/Pages/Documents/Data-Filters" target="_blank">data 
filters</a></strong>. So, it automatically filters tenant datas if you properly 
use filter interfaces. Read
<a href="http://aspnetboilerplate.com/Pages/Documents/Multi-Tenancy" target="_blank">
multi tenant documentation</a> if you are building multi-tenant applications.</p>
<h4>Web Site Root URL</h4>

<p><strong>appsettings.json</strong> file contains a setting, named "<strong>WebSiteRootAddress</strong>", 
which stores root URL of the web application:</p>
<pre lang="xml">"WebSiteRootAddress": "http://localhost:62114/"</pre>
<p>It's used to calculate some URLs in the application. So, you need to change 
this on deployment. For multi-tenant applications, this URL can contain dynamic 
tenancy name. In that case, put {TENANCY_NAME} instead of tenancy name like:</p>
<pre lang="xml">"WebSiteRootAddress": "http://<strong>{TENANCY_NAME}</strong>.mydomain.com/"</pre>
<p>Thus, AspNet Zero can automatically detect current tenant from URLs. If you 
configure it as above, you should also redirect all subdomains to your 
application. To do that;</p>
<ol>
	<li>You should configure DNS to redirect all subdomains to a static IP 
	address. To declare 'all subdomains', you can use a wildcard e.g. <strong>*.mydomain.com</strong>.</li>
	<li>You should configure IIS to bind this static IP to your application.</li>
</ol>
<p>There may be other ways of doing it but this is the simplest.</p>

<h3>Front End Application</h3>
<p>ASP.NET Zero contains front-end pages that can be a starting point for your 
public web site or a landing page for the application. When you first run the 
project, you will see the Home Page as shown below:</p>
<p>
<img class="img-thumbnail" alt="Frontend home page" height="496" src="images/frontend-homepage.jpg" width="500" /></p>
<p>There are two pages here: <strong>Home Page</strong> and <strong>About</strong>. 
Contents of these pages are just placeholders and for demo purposes. You can 
completely remove content and build your page upon your needs. Also, you should 
change the <strong>logo</strong> with your Company's logo.</p>
<p>See
<a href="http://keenthemes.com/multi-purpose-corporate-frontend-themefreebie-corporate-frontend-theme/" target="_blank">metronic front-end theme 
</a>for all possibilities and components to build a 
richer web site.</p>
<p>Menus 
are defined in <strong>FrontEndNavigationProvider</strong> class. When you add a new 
menu item here, it will be automatically shown in the menu. There is a <strong>Login</strong> 
link at the top right corner. This link takes us to the <strong>Login page
</strong>to enter to the <strong>backend</strong> application.</p>
<h4>Layout</h4>
<p>Layout of front-end pages are located under <strong>Views/Layout</strong> folder of the 
<strong>.Web</strong> project:</p>
<p>
<img class="img-thumbnail" alt="Frontend layout views" height="253" src="images/frontend-layout-views-core.png" width="193" /></p>
<p><strong>_Layout</strong> is the main layout file that includes scripts and 
styles. Language flags and the menu is rendered in <strong>Header component</strong> 
which is located under Shared/Components. _PreFooter is not used but you can add it to the _Layout if you want.</p>
<h4>Tenant Sign Up</h4>
<p>When you click the "New tenant" link in the front end application, you can 
sign up to become a new tenant:</p>
<p>
<img class="img-thumbnail" alt="Tenant Signup" height="545" src="images/tenant-signup.png" width="418" /></p>
<p>Here, you can create a new tenant. <strong>TenantRegistration</strong>Controller 
is used to register a new tenant. Tenant registration can be enabled/disabled 
and some settings can be changed in the settings page of the backend application.</p>
<h3>Account Controller</h3>
<p><strong>AccountController</strong> provides <strong>login</strong>, <strong>register</strong>,
<strong>forgot password </strong>and <strong>email activation</strong> pages.</p>
<h4>Layout</h4>
<p>Account management pages have a seperated <strong>_Layout</strong> view under 
<strong>Views/Account</strong> folder:</p>
<p>
<img class="img-thumbnail" alt="Account views" height="218" src="images/account-views-core.png" width="198" /></p>
<p>
Related <strong>Script </strong>and <strong>Style </strong>resources located under
<strong>view-resources/Views/Account</strong> folder:</p>
<p>
<img class="img-thumbnail" alt="Account view resources" height="347" src="images/account-views-core-resources.png" width="205" /></p>
<p>
As similar, all views of the application have corresponding style and script 
files under <strong>wwwroot/view-resources</strong> folder.</p>
<h4>Login</h4>
<p>Main view for AccountController is the Login page:</p>
<p>
<img class="img-thumbnail" alt="Login page" src="images/login-screen-1.png" /></p>
<p>The <strong>tenant selection</strong> section above login section is shown only in a 
<strong>multi-tenant</strong> application and if "subdomain tenancy name detection" is 
<strong>not possible </strong>(See host settings section). When we click Change 
link, tenant change dialog appears and we can change the tenant. There is a single tenant named <strong>Default</strong> 
in the initial database (See Entity framework section for initial seed 
data).&nbsp;Leave tenancy name input as blank to login as <strong>host</strong>.</p>
<p>We can use <strong>admin</strong> user name and <strong>123qwe</strong> 
password in first run the application. At first login, we should change admin 
password since 123qwe is not very secure:</p>
<p>
<img class="img-thumbnail" alt="Change password" height="304" src="images/account-change-password.png" width="422" /></p>
<p>
After changing password we are redirected to the <strong>backend application</strong>.</p>
<h4>Social Logins</h4>
<p>
ASP.NET Zero supports social media logins. To enable it, we should change 
the following settings in <b>a</b><span class="auto-style3">ppsettings.json</span> file.</p>
<pre lang="js">  &quot;Authentication&quot;: {
    &quot;Facebook&quot;: {
      &quot;IsEnabled&quot;: &quot;false&quot;,
      &quot;AppId&quot;: &quot;&quot;,
      &quot;AppSecret&quot;: &quot;&quot;
    },
    &quot;Google&quot;: {
      &quot;IsEnabled&quot;: &quot;false&quot;,
      &quot;ClientId&quot;: &quot;&quot;,
      &quot;ClientSecret&quot;: &quot;&quot;
    },
    &quot;Twitter&quot;: {
      &quot;IsEnabled&quot;: &quot;false&quot;,
      &quot;ConsumerKey&quot;: &quot;&quot;,
      &quot;ConsumerSecret&quot;: &quot;&quot;
    },
    &quot;Microsoft&quot;: {
      &quot;IsEnabled&quot;: &quot;false&quot;,
      &quot;ConsumerKey&quot;: &quot;&quot;,
      &quot;ConsumerSecret&quot;: &quot;&quot;
    }
  },</pre>
<p>
You can find many documents on the web to learn how to obtain authentication 
keys for social platforms. So, 
we will not go to details of creating apps on social medias. Once you get your 
keys, you can write them into appsettings.json. When you enable it, social media logos 
are automatically shown on the login page as shown below:</p>
<p>
<img class="img-thumbnail" alt="Social Login Icons" height="535" src="images/social-login-logos-2.png" width="416" /></p>
<h4>
OpenId Connect Login</h4>
<p>
In addition to social logins, ASP.NET Zero includes OpenId Connect Login 
integrated. It's configuration can be changed in <span class="auto-style3">
appsettings.json</span>:</p>
<pre lang="js">"OpenId": {
  "IsEnabled": "false",
  "Authority": "",
  "ClientId": "",
  "ClientSecret": ""
}</pre>
<p>A logo (similar to social logos above) is shown in Login page when it's 
enabled.</p>
<h4>Two Factor Login</h4>
<p>ASP.NET Zero is ready to provide two factor login, but it's disabled as 
default. You can easily enable it in host settings page (in Security tab):</p>
<p>
<img class="img-thumbnail" alt="" height="405" src="images/lockout-two-factor-settings.png" width="490" /></p>
<p>
Note: In a multi-tenant application, two factor authentication is available to 
tenants only if it's enabled in the host settings. Also, email verification and 
SMS verification settings are only available in the host side. This is by 
design.</p>
<p>
When it's enabled, user is asked to select a verification provider after 
entering user name and password:</p>
<p>
<img class="img-thumbnail" alt="Send security code" height="313" src="images/send-security-code.png" width="421" /></p>
<p>
Then a <strong>confirmation code</strong> is sent to the selected provider and 
user enters the code in the next page:</p>
<p>
<img class="img-thumbnail" alt="Verify security code" height="292" src="images/verify-security-code.png" width="419" /></p>
<h5>
Email Verification</h5>
<p>
This is available if user has a confirmed email address. Since email sending is 
disabled in debug mode, you can see the code in logs. In release mode, email 
will be sent (You can change this and make emailing available in also debug. See 
sending emails section).</p>
<h5>
SMS Verification</h5>
<p>
This is available if user has a confirmed phone number. SMS sending is not 
implemented actually (because it requires an integration to an SMS vendor). 
Current implementation just writes security code to logs. You should complete
<strong>IdentitySmsMessageService</strong> class in the solution to make it 
usable. Otherwise, disable SMS verification in the settings.</p>
<h4>User Lockout</h4>
<p>As seen in the previous section, you can configure user lockout settings. 
Users are lockout when they enter wrong password for a specified count and 
duration.</p>
<h4>Register</h4>
<p>When we click the "<strong>Create Account</strong>" link in the login page, a 
registration form is shown:</p>
<p>
<img class="img-thumbnail" alt="Registration form" height="488" src="images/registration-form-small.png" width="250" /></p>
<p>A user can be register for a tenant, not for host if this is a multi-tenant 
application. If it's single-teant, there will be no tenancy name input here.</p>
<p><strong>Recaptcha</strong> (security question) is optional. It uses Google's recaptcha 
service. Recaptcha service works per domain. So, to make it properly work, you 
should create your own private and public keys for your domain on
<a href="https://www.google.com/recaptcha">https://www.google.com/recaptcha</a> 
and replace keys in <strong>appsettings.json</strong> file.</p>
<h4>Email Activation</h4>
<p>When a user registers as shown above, an email confirmation code is sent to 
his email address. If user did not receive this email for some reason, he can 
click Email activation and re-send the confirmation code.</p>
<p>
<img class="img-thumbnail" alt="Email activation screen" height="363" src="images/email-activation.png" width="417" /></p>
<p>Again, Tenancy name input is not shown for a single-tenant application or 
tenant name is known via subdomain (like tenancyname.mydomain.com).</p>
<h4>Forgot Password</h4>
<p>If a user forgots his password, he can click the "Forgot Password" link to 
get an email to reset the password.</p>
<p>
<img class="img-thumbnail" alt="Forgot password" height="359" src="images/forgot-password.png" width="421" /></p>
<h3>Back End Application</h3>
<p>This is the actual application which is entered by username and password. You 
will mostly work on this application to add your business requirements.</p>

<h4>Application Folders</h4>
<p>Backend application is built in a dedicated area, named "<strong>App</strong>" 
by default, but can be determined while you are <a href="Getting-Started.html">
creating the solution</a>. So, all controllers, views and models are located under <strong>
Areas/App</strong> folder. Also, related script and style files are located 
under <strong>wwwroot/view-resources/Areas/App</strong> folder, as shown below:</p>
<p>
<img class="img-thumbnail" alt="Application folders" height="381" src="images/app-folders-core.png" width="161" /></p>
<h4>Main Menu</h4>
<p>Application's main menu is defined in <strong>AppNavigationProvider</strong> 
class. See ABP's
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Navigation">navigation 
documentation</a> to have a deep understanding on creating menus. When you add a 
new menu item, it's automatically rendered in the layout.</p>
<h4>Layout</h4>
<p>Layout of the application is located under <strong>Areas/App/Views/Layout</strong> 
folder. It uses <strong>Components</strong> for <strong>header</strong>, <strong>footer</strong> and <strong>
sidebar</strong>:</p>
<p>
<img class="img-thumbnail" alt="Application layout" height="255" src="images/app-layout-core.png" width="137" /></p>
<p>Main menu is rendered in
<strong>sidebar</strong> component. Layout also highly uses bundling &amp; 
minification (see the section below) system for script and style includes.</p>
<h4>Edition Management</h4>
<p><em>If you're not developing a multi-tenant application, you can skip this 
section.</em></p>
<p>Most <strong>SaaS</strong> (multi-tenant) applications have <strong>editions</strong> (packages) those have different 
<strong>features</strong>. Thus, they can provide different <strong>price and feature options</strong> to thier tenants (customers).&nbsp;<strong>Editions 
page</strong> (available in host login)<strong> </strong>is used to manage 
application's editions:</p>
<p>
<img class="img-thumbnail" alt="Editions page" height="227" src="images/editions-page-core.png" width="800" /></p>
<p>Editions are used to group feature values and assign to tenants. When we 
click Actions/Edit for an edition, we can see it's assigned features:</p>
<p>
<img class="img-thumbnail" alt="Edit edition features" height="343" src="images/edition-feature-editing-core.png" width="615" /></p>
<p>Startup project only contains Chat feature (and it's 2 sub-features) that can 
be enabled/disabled per edition/tenant. All features are defined in <strong>
AppFeatureProvider</strong> class. Feature values are stored in <strong>
AbpFeatures</strong> table. Features are not restricted to boolean 
(enabled/disabled) values and can contain different type of values as shown 
below:&nbsp;</p>
<p>
<img class="img-thumbnail" alt="Edition feature editing" height="317" src="images/edition-feature-editing.png" width="613" /></p>
<p>&nbsp;See
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Feature-Management">
feature management</a> and
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Zero/Edition-Management">
edition management</a> documents for more information.</p>

<h4>Tenant Management</h4>

<div class="note note-info">
<p><em>If you're not developing a multi-tenant application, you can skip this 
section.</em></p>
</div>

<p>If this is a multi-tenant application and you logged in as a host user, then 
tenants page is shown:</p>
<p>
<img class="img-thumbnail"  alt="Tenant management page" height="272" src="images/tenant-management-core.png" width="1168" /></p>
<p>A tenant is represented by <strong>Tenant</strong> class. Tenant class 
<a href="Extending-Existing-Entities.html">can be 
extended</a> by adding new properties. There is an only 
one tenant, named <strong>Default</strong> as initial.<strong> Tenancy Name</strong> (code name) is the <strong>unique</strong> name 
of a tenant. A&nbsp;tenant can be <strong>active</strong> or <strong>passive</strong>. 
If it's passive, no user of this tenant can login to the application.</p>
<p>When we 
click the "<strong>Create New Tenant</strong>" button, a dialog is shown:</p>
<p>
<img class="img-thumbnail" alt="Creating tenant" height="667" src="images/create-tenant-4.png" width="615" /></p>
<p><strong>Tenancy name</strong> should be unique and not contain spaces or 
other special chars since it may be used as subdomain name (like 
tenancyname.mydomain.com. See the section below). <strong>Name</strong> can be anything. <strong>Admin email</strong> 
is used as email address of the admin user of new tenant. Admin user is 
automatically created with the tenant. We can set a random password for admin and send activation email. When user 
first logins, he/she should change the password. We can uncheck this to enter a known 
password.</p>
<p>When we create a new tenant, we should select/create a database to store new 
tenant's data. We can select '<strong>Use host database</strong>' to store 
tenant data in host database (can be used for single database approach) or we 
can specify a connection string to create/use a <strong>dedicated database
</strong>for new tenant. AspNet Zero supports <strong>hybrid </strong>approach. 
That means you can use host database for some tenants and create dedicated 
databases for some other tenants. Even you can <strong>group </strong>some 
tenants in a separated database.</p>
<p>All tenant actions are handled by <strong>TenantAppService</strong> 
class. Example (deleting a tenant):</p>
<pre lang="cs">[AbpAuthorize(AppPermissions.Pages_Tenants_Delete)]
public async Task DeleteTenant(EntityRequestInput input)
{
    var tenant = await TenantManager.GetByIdAsync(input.Id);
    CheckErrors(await TenantManager.DeleteAsync(tenant));
}</pre>
<p>TenantAppService mostly uses <strong>TenantManager</strong> domain service 
for tenant operations..</p>
<h5>Tenant Edition and Features</h5>
<p>An <strong>edition</strong> can be <strong>assigned</strong> to a tenant 
(while creating or editing). Tenant will inherit all features of the assigned 
edition. But we can also override features and values for a tenant. Click
<strong>actions/change features</strong> for a tenant to <strong>customize</strong> 
it's features:</p>
<p>
<img class="img-thumbnail" alt="Tenant features" height="239" src="images/tenant-features-core.png" width="615" /></p>
<h5>Tenant User Impersonation</h5>
<p>As a host user, we may want to perform operations in behalf of a tenant. In 
this case, we can click the "<strong>Login 
as this tenant</strong>" button in the actions. When we click it, we see <strong>a modal to select a user</strong> of the 
tenant. We can select any user and perform operations allowed that user. See
<strong>User Impersonation</strong> section in this document for more 
information.</p>
<h5>Using Tenancy Name As Subdomain</h5>
<p>A multi-tenant application generally uses subdomain to identify current tenant.
<strong>tenant1</strong>.mydomain.com, <strong>tenant2</strong>.mydomain.com and 
so on. ASP.NET Zero automatically identify and get tenant name from subdomain 
(See host settings section).</p>
<h4>Organization Units</h4>
<p>Organization units (OU) are used to hierarchically group user and entities. 
Then you can get user or entities based on their OUs. When we click 
Administration/Organization units, we enter the related page:</p>
<p>
<img class="img-thumbnail" alt="Organization units page" height="483" src="images/organization-units-page-core.png" width="931" /></p>
<p>Here, we can manage OUs (create, edit, delele, move) and members 
(add/remove).</p>
<p><strong>OrganizationUnitManager</strong> is used to manage OUs, <strong>
UserManager</strong> is used to manage OU members in the code. <strong>
OrganizationUnitAppService</strong> performs the application logic.</p>
<p>In the left OU tree, we can <strong>right click</strong> to an OU (or left click to
<strong>arrow</strong> at the right) to open <strong>context menu</strong> for OU operations. When we try to 
<strong>add a 
member</strong>, a modal is shown to select the user:</p>
<p>
<img class="img-thumbnail" alt="Select a user dialog" height="549" src="images/select-user-lookup-core.png" width="583" /></p>
<p>This is actually a <strong>generic lookup modal</strong> and can be used to 
select any type of entity (see Areas/App/Views/Common/Modals/_LookupModal.cshtml 
and it's related script file). To select the users, we created <strong>FindUsers</strong> 
method in <strong>CommonLookupAppService</strong> then configured the modal to 
work with this method (see view-resources/Areas/App/Views/OrganizationUnits/index.js file for usage of 
lookupModal.open).</p>
<p>See
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Zero/Organization-Units">
organization unit management document</a> for more information.</p>
<h4>Role Management</h4>

<p>When we click Administration/Roles menu, we enter to the role management page:</p>
<p>
<img class="img-thumbnail" alt="Role management page" height="333" src="images/role-management-core.png" width="702" /></p>
<p>Roles are used to <strong>group permissions</strong>. When a user has a 
role, then he/she will have all permissions of that role.</p>
<p>A role is represented by the <strong>Role</strong> class. Role class can be 
extended by adding new properties.</p>
<p><strong>RoleManager</strong> performs domain logic, <strong>RoleAppService</strong> 
performs application logic for roles.</p>
<p>Roles can be 
dynamic or static:</p>

<ul>
	<li><strong>Static role</strong>: A static role has a known <strong>name
	</strong>(like 'admin') and can not change this name (we can change <strong>
	display name</strong>). It's exists on the system startup and can not be 
	deleted. Thus, we can write codes based on a static role name.</li>
	<li><strong>Dynamic role</strong>: We can create a dynamic role 
	after deployment. Then we can grant permissions for that role, we can assign 
	the role to some users and we can delete it. We can not know names of 
	dynamic roles in development time.</li>
</ul>

<p>One or more roles can be set as <strong>default</strong>. Default roles are 
assigned to new added/registered users as default. This is not a development 
time property and can be set or changed after deployment.</p>

<p>In startup project, we have static <strong>admin </strong>role for host (for 
multi-tenant apps). Also, we have static <strong>admin </strong>and <strong>user </strong>
roles for tenants. <strong>Admin </strong>roles have all permissions granted by 
default. <strong>User </strong>role is the <strong>default</strong> role for new users and has no 
permission by default. These can be changed easily. See <strong>StaticRoleNames</strong> class for 
all static roles and <strong>AppRoleConfig</strong> for changing static roles.</p>
<h5>Role Permissions</h5>
<p>Since roles are used to group permissions, we can set permissions of a role 
while creating or editing as shown below:</p>
<p>
<img alt="Role Permissions" height="823" src="images/role-permissions-core.png" width="614" /></p>
<p>(not all permissions shown in the figure above)</p>
<p>Every tenant has it's own roles and any change in roles for a tenant does not effect other 
tenants. Also, host has also own isolated roles.</p>
<h4>User Management</h4>

<p>When we click Administration/Users menu, we enter to the user management page:</p>
<p>
<img class="img-thumbnail" alt="User management" height="635" src="images/user-management-core.png" width="1643" /></p>

<p><strong>Users</strong> are people who can <strong>login </strong>to the application and 
perform some operations based on their <strong>permissions</strong>.</p>
<p><strong>User</strong> class represents a user. User class 
<a href="Extending-Existing-Entities.html">can be extended</a> by 
adding new properties.</p>
<p><strong>UserManager</strong> 
is used to perform domain logic, <strong>UserAppService</strong> is used to 
perform application logic for users.</p>

<p>A user can have zero or more <strong>roles</strong>. If a user has more than 
one role, he inherits union of 
permissions of all these roles. Also, we can set <strong>user-specific permission</strong>. 
A user specific permission setting overrides role settings for this permission. 
A screenshot of user permission dialog:</p>
<p>
<img class="img-thumbnail" alt="User Permissions" height="481" src="images/user-permissions.png" width="620" /></p>
<p>(not all permissions shown in the figure above)</p>
<p>A dialog is used to create/edit a user:</p>
<p>
<img class="img-thumbnail" alt="Editing User" src="images/edit-user-2.png" /></p>
<p>We can change user's <strong>password</strong>, make her <strong>
active/passive</strong> and so on... A user can have a <strong>profile picture</strong>. 
It can be changed by the user (See User Menu section). <strong>Admin</strong> 
user can not be deleted as a business rule. If you don't want to use admin, you 
can make it passive.</p>
<h5>User Impersonation</h5>
<p>As admin (or any allowed user), we may want to login as a user and perform 
operations in behalf of that user, without knowing his password. When we click "<strong>Login as this user</strong>" 
icon in the actions of a user, we are automatically redirected and logged in as this user. 
This is called as "<strong>user impersonation</strong>". When we impersonate a user, a "<strong>back to 
my account</strong>" option is added to the user profile menu:</p>
<p>
<img class="img-thumbnail" alt="Back to my account link" height="368" src="images/back-to-my-account-link-2.png" width="211" /></p>
<p>In an impersonated account, we can only perform operations allowed to that 
user. That means, everything <strong>exactly</strong> works as same as this user 
logged in himself. The only difference is shown in audit logs which indicates 
that operations are performed by somebody else. Notice that; Also a <strong>red 
'back' icon</strong> shown near to the user name to indicate that you are in an 
impersonated account.</p>
<p>Impersonation is done in <strong>AccountController</strong> of the Web 
project.</p>
<h4>Language Management</h4>
<p>Language management page is used to manage (add/edit/delete) <strong>application 
languages</strong> and change <strong>localized texts</strong>:</p>
<p>
<img class="img-thumbnail" alt="Language management" height="510" src="images/language-list-core.png" width="752" /></p>
<p>We can create new language, edit/delete an existing language and <strong>set a 
language as default</strong>. Note that; tenants can not edit/delete default 
languages, but host users can do.</p>
<p>When we click to <strong>Change text</strong> for any language, we are 
redirected to a new view to edit language texts:</p>
<p>
<img class="img-thumbnail" alt="Language texts" height="630" src="images/language-change-texts-list-core.png" width="945" /></p>
<p>We can select any language as a <strong>base</strong> (reference) and change 
<strong>target</strong> language's 
texts. Base language is just to help the translation progress. Since there maybe different
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Localization#DocLocalizationSources">
localization sources</a>, we select the source to translate. When we click the 
edit icon, we can see the edit modal for the selected text:</p>
<p>
<img class="img-thumbnail" alt="Language text editing" height="409" src="images/language-change-text-modal-core.png" width="608" /></p>
<p><strong>Host</strong> users (if allowed) can edit languages and localized 
texts. These languages will be default for all tenants for a multi-tenant application.
<strong>Tenants</strong> inherit languages and localized texts and can <strong>
override</strong> localized texts or can add new languages.</p>
<p>Both pages use <strong>LanguageAppService</strong> class as application 
service. It has methods to manage languages and localized texts. <strong>
IApplicationLanguageManager</strong> and <strong>IApplicationLanguageTextManager</strong> 
interfaces are used to perform domain logic (as used by LanguageAppService).</p>
<p>See <a href="http://www.aspnetboilerplate.com/Pages/Documents/Zero/Language-Management">
language management</a> and
<a href="http://aspnetboilerplate.com/Pages/Documents/Localization" target="_blank">
localization</a> documents for more information.</p>
<h4>Audit Logs</h4>
<p>In audit logs page, we can see all user interactions with the application:</p>
<p>
<img class="img-thumbnail" alt="Audit logs" height="671" src="images/audit-logs-core.png" width="1287" /></p>
<p>All application service methods and MVC controller actions are automatically logged and can be viewed 
here. See
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Audit-Logging">audit 
logs documentation</a> to learn how to configure it. When we click the magnifier 
icon, we can see all details an audit log:</p>
<p>
<img class="img-thumbnail" alt="Audit Log" height="827" src="images/audit-logs-detail.png" width="620" /></p>
<p>
Audit log report is provided by <strong>AuditLogAppService</strong> class.</p>
<h4>Host Settings</h4>
<p>Host settings page is used to configure some system settings:</p>
<p>
<img class="img-thumbnail" alt="General Host Settings" src="images/host-settings-general-4.png" /></p>
<p><strong>Timezone</strong> is an important setting in this page. AspNet 
Zero can work in multiple zones. Each user can see dates and times in their own time zone. Timezone setting in this 
page allows you to set default time zone for the application including all 
tenants and users. Tenants and users can change time zone in their own settings. 
Timezone setting is available only if you are using UTC clock.
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Timing" target="_blank">
See documentation</a> to switch to UTC.</p>
<p>SAVE ALL button saves 
all settings in one click. HostSettingAppService is used to retrieve and save 
settings (See setting provider section for more information).</p>
<p><strong>Security</strong> tab in host settings page contains password complexity settings. Host can define system wide password complexity settings in this tab. Each tenant can override this setting in tenant settings page. <strong>PasswordComplexityChecker</strong> 
class is responsible for checking if a password satisfies the password complexity settings.</p>
<img class="img-thumbnail" alt="Tenant settings" src="images/host-settings-security.png" />
<h4>Tenant Settings</h4>
<p>In a multi-tenant application, tenant settings are shown as below:</p>
<p>
<img class="img-thumbnail" alt="Tenant settings" height="421" src="images/tenant-settings-core.png" width="762" /></p>
<p>If we disable multi-tenancy, some host settings are also shown in this page (since 
there is no host setting page). Tenants can also define password complexity settings for their users or they can use password complexity settings defined by host user.</p>
<p><strong>TenantSettingAppService</strong> is used to get/set tenant settings.</p>
<h5>Enabling LDAP (Active Directory) Authentication</h5>
<p>LDAP (Active Directory) Authentication is disabled by default. To make it 
work, we should disable multi-tenancy since LDAP auth is not used in a 
multi-tenant system normally. In CoreModule class in .Core project, we should 
enable the following line:</p>
<pre lang="cs">Configuration.Modules.ZeroLdap().Enable(typeof(AppLdapAuthenticationSource));</pre>
<p>Then, we can see <strong>LDAP settings</strong> section in settings page:</p>
<p>
<img class="img-thumbnail" alt="LDAP Settings" height="569" src="images/tenant-settings-ldap.png" width="764" /></p>
<p>We can check "<strong>Enable LDAP Authentication</strong>" to enable it. If 
the server works in domain and application runs with a domain user or local 
system, then generally even <strong>no need</strong> to set Domain name, user and password. You 
can logout and then login with your <strong>domain user name and password</strong>. 
If not, you should set these credentials.</p>
<h4>Maintenance</h4>
<p>Maintenance page is available to <strong>host side</strong> for multi tenant 
applications (for single tenant applications it's shown in tenant side) and 
shown as below:</p>
<p>
<img class="img-thumbnail" alt="Maintenance cache" height="525" src="images/maintenance-cache.png" width="729" /></p>
<p>In the <strong>Caches</strong> tab, we can clear some or all caches. Clearing 
caches may be needed if you manually change database and want to refresh 
application cache. <strong>CachingAppService</strong> is used to clear caches in 
the server side.</p>
<p><strong>Website Logs</strong> tab is used to see and download 
logs: </p>
<p>
<img class="img-thumbnail" alt="Maintenance logs" height="561" src="images/maintenance-logs.png" width="727" /></p>
<p><strong>WebLogAppService</strong> is used to get logs from server.</p>

<h4>Tenant Dashboard</h4>
<p>ASP.NET Zero startup project also includes a <strong>sample</strong> 
dashboard. It's just for demo purposes, you can make it as a start point for 
your actual dashboard:</p>
<p>
<img class="img-thumbnail" alt="Dashboard" height="594" src="images/default-dashboard2.png" width="800" /></p>
<p>Here, only <strong>Member Activity</strong> graph data is retrieved from server (from 
<strong>TenantDashboardAppService</strong>). You can click the refresh button to generate random 
graphs.</p>
<h4>Notifications</h4>
<p>Notification icon is located next to the language selection button. The number in the red circle shows unread notification count.</p>
<p><img alt="notifications" src="images/notifications-icon.png" width="189" class="img-thumbnail"/></p>
<p>User can see 3 recent notifications by clicking this icon. </p>
<p><img alt="notifications" src="images/recent-notifications.png" width="320" class="img-thumbnail" style="height: 424px"/></p>
<p>User can marks all notifications as read by clicking the "Set all as read" link or can mark a single notification by clicking the "set as read" link next to each notification.</p>
<p>Notifications are sent real-time using SignalR. In addition, a <strong>
desktop push notification</strong> is shown when a notification is received.</p>
<h5>Notification Settings</h5>
<p>"Settings" link opens notification settings dialog.</p>
<p><img alt="notifications" src="images/notification-settings.png" width="601" class="img-thumbnail" style="height: 311px"/></p>
<p>In this dialog there is a global setting for user to enable/disable receiving notifications. If this setting is enabled, then user can enable/disable each notification individually.</p>
<p>You can also define your custom notifications in <strong>AppNotificationProvider</strong> 
class. For example, new user registration notification is defined in the <strong>AppNotificationProvider</strong> as below.</p>
<pre lang="cs">context.Manager.Add(
     new NotificationDefinition(
        AppNotificationNames.NewUserRegistered,
        displayName: L("NewUserRegisteredNotificationDefinition"),
        permissionDependency: new SimplePermissionDependency(AppPermissions.Pages_Administration_Users)
    )
);
</pre>
<p>See <a href="http://aspnetboilerplate.com/Pages/Documents/Notification-System#notification-definitions">notification definitions</a> 
section for detailed information.</p>
<p><strong>AppNotifier</strong> class is used to publish notifications. 
<strong>NotificationAppService</strong> class is used to manage application logic for notifications. 
See <a href="http://aspnetboilerplate.com/Pages/Documents/Notification-System">notifications documentation</a> for detailed information.</p>
<h5>Notification List</h5>
<p>All notifications of user are listed in this page.</p>
<p>
<img class="img-thumbnail" alt="Notification list" height="313" src="images/notifications-list-core.png" width="774" /></p>

<h4>Chat</h4>
<p>Chat icon is located next to user's profile image on top right corner of the page.  The number in the red circle shows total unread chat message count.</p>
<p><img class="img-thumbnail" alt="User menu" src="images/chat-icon.png" /></p>
<p>When user clicks this icon, chat panel appears on the right of page. This panel contains friends of user and list of blocked users.</p>
<img class="img-thumbnail" alt="User menu" src="images/chat-friends.png" />
<p>User can add new friends by writing the username into username textbox above friend list. If "Chat with other tenants" feature is enabled for tenant, users of other tenants can be added as a friend by writing [tenancy name]\[user name] (ex: Default\admin). If "Chat with host users" feature is enabled, host users can be added as friend by writing .\[user name] in the same textbox.</p>
<p>While online friends/users have a green circle on their profile image, offline friends/users 
have a gray circle.</p>
<p>User can pin or unpin the chat panel by clicking the pin icon on top right corner of the chat panel. Application tries to remember last state of chat panel and restores it when user login to application.</p>
<p>When a friend/user is selected, conversation panel is opened.</p>
<img class="img-thumbnail" alt="User menu" src="images/chat-conversation.png" />
<p>User can block or unblock friend/user in this area. There is a wrench icon right of the selected user's username. This icon opens an action menu and this menu contains block user or unblock user actions according to user's block status.</p>
<p>Chat messages are distrubited over <strong>ChatHub </strong>signalR hub class which uses <strong>ChatMessageManager</strong> domain class. </p>
<p><strong>ChatUserStateWatcher</strong> class is responsible for watching online/offline state changes of chat users. When a user becomes online or offline, this class catches the state change and notifies friends of related user.</p>
<p><strong>FriendshipAppService</strong> and <strong>FriendshipManager</strong> classes are responsible for managing friendship requests. Chat messages from blocked users are not delivered to target users.</p>
<p>Since chat is a real time operation, application caches friends of online users and unread message count from each friend. <strong>UserFriendsCache</strong> 
class manages these caching operations. </p>
<p><strong>UserFriendCacheSyncronizer</strong> class is responsible for keeping user friends cache up to date. In order to do that, it watches some events of Friendship and ChatMessage entities.</p>
<h5>Chat Features</h5>
<img class="img-thumbnail" alt="User menu" src="images/chat-features.png" />
<p>There are three chat features in the system. These are "Chat", "Chat with host", "Chat with other tenants". These features can be enabled/disabled 
per edition/tenant. By using these features host can enable/disable chat with other tenant's users or host users.</p>
<h4>User Menu</h4>
<p>A user can click his name at top right corner to open user menu:</p>
<p>
<img class="img-thumbnail" alt="User menu" height="307" src="images/user-menu-3.png" width="382" /></p>
<h5>Linked Accounts</h5>
<p>Linked accounts are used to link multiple accounts to each other. In this 
way, a user can easily navigate through his/her accounts using this feature.</p>
<p>User can link new accounts or delete already linked accounts by clicking the 
"Manage accounts" link.</p>
<p><img class="img-thumbnail" alt="User menu" src="images/linked-accounts.png"/></p>
<p>
In order to link a new account, user must enter login credentials of related account.</p>
<p><img class="img-thumbnail" alt="link new account" height="353" src="images/link-new-account.png" width="599"/></p>
<p><strong>UserLinkAppService</strong> class is used to manage application logic for account linking, 
<strong>UserLinkManager</strong> class is used to manage domain logic for account linking. </p>
<h5>Profile Settings</h5>
<p>My settings is used to change user profile settings:</p>
<p>
<img class="img-thumbnail" alt="User settings" height="557" src="images/user-settings-2.png" width="614" /></p>
<p>As shown here, <strong>admin</strong> user name can not be changed. It's 
considered a special user name since it's used in database migration seed. Other 
users can change their usernames. <strong>ProfileAppService</strong> is used to 
get/change settings.</p>
<h5>Login Attempts</h5>
<p>All login attempts (success of failed) are logged in the application. A user 
can see last login attempts for his/her account. <strong>UserLoginAppService</strong> 
is used to get login attempts from server.</p>
<p>
<img class="img-thumbnail" alt="Login attempts" height="538" src="images/login-attempts.png" width="611" /></p>
<h5>Change Picture</h5>
<p>A user can change own profile picture. <strong>ProfileController</strong> is 
used to upload and get user profile pictures.
Currently, jpg/jpeg, gif and png files are supported, you can extend it.</p>
<h5>Change Password</h5>
<p><strong>ProfileAppService</strong> is used to change password.</p>
<h5>Logout</h5>
<p><strong>AccountController</strong> is used to logout the user and redirect to 
Login page.</p>
<h3>Web.Host Application</h3>
<p>AspNet Zero solution contains an extra project, <strong>Web.Host</strong>, 
which just exposes all application functionality as <strong>remote API</strong>. 
Thus, you can consume your application as API from any device. Actually, Web.Mvc 
project also does it, provides API for all application functionality. The 
difference is that Web.Mvc project has also MVC Controllers, Views, scripts and 
so on. If you just want to deploy API without UI, you can use Web.Host project. 
Otherwise, you can even delete it. We are using Web.Host project to provide 
server side API to <a href="Development-Guide-Angular.html">Angular SPA</a>.</p>
<p>A few notes on Web.Host project:</p>
<ul>
	<li>It has only <strong>token based (JWT) authentication</strong> (plus 
	social login possibility). No form based authentication (because there is no 
	UI).</li>
	<li>It does <strong>not</strong> implement <strong>CSRF</strong> protection 
	since it's not a security concern in token based auth.</li>
	<li>&nbsp;It enables <strong>CORS</strong>. So, cross origin requests are 
	allowed. It only allows to <strong>http://localhost:4200</strong> by default 
	(see Startup class for the configuration).</li>
	<li>Configured and enabled <strong>Swagger UI</strong> by default.</li>
</ul>
<h3>Migrator Console Application</h3>
<p>AspNet Zero includes a tool, Migrator.exe, to easily migrate your databases. 
You can run this application to create/migrate host and tenant databases.</p>
<p>
<img class="img-thumbnail" alt="Database Migrator" height="230" src="images/database-migrator.png" width="659" /></p>
<p>This application gets host connection string from it's <strong>own 
appsettings.json 
file</strong>. It will be same as in the appsettings.json in .Web project at the beggining. Be sure that 
the connection string in config file is the database you want. After getting
<strong class="auto-style2">host </strong><strong>connection sring</strong>, it 
first creates the host database or apply migrations if it does already exists. 
Then it gets connection strings of tenant databases and runs migrations for 
those databases. It skips a tenant if it has not a dedicated database or it's 
database is already migrated for another tenant (for shared databases between 
multiple tenants).</p>
<p>You can use this tool on development or on product environment to migrate 
databases on deployment, instead of EntityFramework's own Migrate.exe (which 
requires some configuration and can only work for single database in one run).</p>
<h3>Infrastructure</h3>
<h4>Startup Class</h4>
<p>ASP.NET Core is initialized from the <strong>Startup</strong> class in the 
application. We configure all libraries (including ABP) in this class. We 
suggest you to start by checking this class. It is also integrated to <strong>
OWIN</strong>. So, you can add OWIN middlewares here.</p>
<h4>Bower &amp; Front End Dependencies</h4>
<p>ASP.NET Zero solution uses <a href="https://bower.io/" target="_blank">bower</a> 
package manager to obtain front end library dependencies (like bootstrap and 
jquery). So, you can easily add new packages or update existing packages on 
Visual Studio or bower's command line interface. You can see all installed bower 
packages under <strong>Dependencies/Bower</strong> of the .Web project.</p>
<p>
<img class="img-thumbnail" alt="Bower dependencies" height="462" src="images/bower-dependencies.png" width="269" /></p>
<h4>Application Services as MVC API Controllers</h4>
<p>ASP.NET Zero project highly use AJAX to provide a better user 
experience. UI calls <strong>application service methods</strong> via AJAX. So, it's needed to create 
MVC API 
controllers as adapters (A Client calls MVC API Controller action via AJAX, then 
it calls application service method).</p>
<p>ABP framework automatically creates
MVC API Controllers for all application services. So, 
no need to manually create MVC API Controller. We build dynamic web api controllers in 
PhoneBook<strong>WebModule</strong> class in .Web project. See related
<a href="http://aspnetboilerplate.com/Pages/Documents/AspNet-Core#application-services-as-controllers" target="_blank">
documentation</a> for more.</p>
<p>While ABP dynamically create Web API Controllers, we can also create regular 
MVC API Controllers as we always do.</p>
<h4>Localization</h4>
<p>ASP.NET Zero <strong>User Interface</strong> is completely
localized. AspNet Zero uses <strong>dynamic, database based, per-tenant</strong> 
localization (See the related section above).</p>
<p>XML files are used as base translation for desired languages:</p>
<p>
<img class="img-thumbnail" alt="Localization XML files" height="217" src="images/localization-files-core.png" width="190" /></p>
<p>PhoneBook will be your ProjectName. You can add more XML files by copying one 
XML file and translate to desired language. See
<a href="http://www.csharp-examples.net/culture-names/" target="_blank">valid 
culture codes</a>.</p>
<p>When you are adding a new localizable text, add it to the XML file of the 
default language then use in your application (Also, add translated values to 
corresponding XML files). No need to add it to database migration code since 
value in the XML file will be used as default.</p>
<p><strong>Application languages</strong> are defined in <strong>
DefaultLanguagesCreator</strong> class. This is used as a <strong>seed data</strong> 
in Entity Framework Migration. So, if you want to <strong>add a new language</strong>, 
just add it into DefaultLanguagesCreator class. Also, you should add a 
corresponding XML file as described above as default translation.</p>
<p>See <a href="http://www.aspnetboilerplate.com/Pages/Documents/Localization">
localization</a> and
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Zero/Language-Management">
language management</a> documentations for more information.</p>
<h4>EntityFramework Integration</h4>
<p>ASP.NET Zero template uses EntityFramework 6.x <strong>code-first</strong> and 
<strong>migrations</strong>. PhoneBook<strong>DbContext</strong> (YourProjectDbContext for your project) 
defines the DbContext class. <strong>Migrations</strong> folder contains EF migrations. </p>
<p>PhoneBook<strong>RepositoryBase</strong> class is the base class for your
custom repositories. See entity
<a href="http://www.aspnetboilerplate.com/Pages/Documents/EntityFramework-Integration">
framework integration</a> documentation for more.</p>
<h5>Database Migrations</h5>
<p>Because of new <strong>xproj/project.json</strong> project structure of 
ASP.NET Core, Entity Framework's "<strong>Update-Database</strong>" and "<strong>Add-Migration</strong>" 
commands <strong>may not properly work</strong>. We used
<a href="https://github.com/mrahhal/Migrator.EF6" target="_blank">Migrator.EF6</a> 
tool&nbsp;to adapt Entity Framework 6.x to the new solution format. So, you can use
<strong>Windows Command Promt</strong> to add migrations and update database.</p>
<p>First, open <strong>cmd</strong> in Windows and locate the folder contains
<strong>.EntityFramework</strong> project file. Then,</p>
<ul>
	<li>Use <strong><em>dotnet ef database update</em></strong> command to apply 
	migrations to database (Instead, you can use Migrator.exe as declared 
	before).</li>
	<li>Use <em><strong>dotnet ef migrations add "Your_Migration_Name"</strong></em> 
	command to add new migrations.</li>
</ul>
<h4>Exception Handling</h4>
<p>ASP.NET Zero uses ABP's
<a href="http://www.aspnetboilerplate.com/Pages/Documents/AspNet-Core#exception-filter" target="_blank">
exception handling</a> system. Thus, you don't need to handle &amp; care about 
exceptions in most time.</p>
<p>ASP.NET Zero solution adds <strong>exception handling middlewares</strong> in the
<strong>Startup</strong> 
class like that:</p>
<pre lang="cs">if (env.IsDevelopment())
{
    app.UseDeveloperExceptionPage();
}
else
{
    app.UseStatusCodePagesWithRedirects("~/Error?statusCode={0}");
    app.UseExceptionHandler("/Error");
}</pre>
<p>So, you get a nicely formatted exception page in development and a more user 
friendly error page in production. See <strong>ErrorController</strong> and it's 
related views (<strong>Views\Error</strong>) for details.</p>
<h4>User Secrets</h4>
<p>ASP.NET Core introduced
<a href="https://docs.asp.net/en/latest/security/app-secrets.html#secret-manager" target="_blank">
user secrets</a> system to store <strong>sensitive data</strong> in development. ASP.NET Zero 
uses this system (it's configured properly for your solution). You may want to 
use a different connection string (or social media API keys) in development and 
do not want to add these secret data in your appsettings.json in the project 
(and do not want to commit these sensitive information to your source control 
system). Then use secret manager tool to store this sensitive information in 
your local computer and allow your application to read them from your local 
computer if available.</p>
<p>For example, you can use the following command, in Windows <strong>command 
prompt</strong> in the location of <strong>Core</strong> project, to change connection string for your 
local development environment:</p>
<pre>dotnet user-secrets set ConnectionStrings:Default "Server=1.2.3.4;Database=MyProjectDevDb;User=sa;Password=12345678"</pre>
<p>This user secret value overrides the value in the appsettings.json. See ASP.NET's
<a href="https://docs.asp.net/en/latest/security/app-secrets.html" target="_blank">
own documentation</a> for details about user secrets.</p>
<h4>Authorization Provider</h4>
<p>Authorization system is based on permissions. <strong>AppPermissions </strong>
contains constants for permission names and <strong>
AppAuthorizationProvider</strong> class defines all permissions in the system. 
We should define a permission here before using it in application layer.</p>
<p>See <a href="http://www.aspnetboilerplate.com/Pages/Documents/Authorization">
authorization documentation</a> to learn how to configure permissions.</p>
<h4>Feature Provider</h4>
<p><strong>AppFeatureProvider</strong> class defines features of the 
application for multi-tenant applications. Feature names are defined in <strong>AppFeatures</strong> 
class as contants.</p>
<p>See
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Feature-Management">feature management 
documentation</a> to learn how to define and use features.</p>
<h4>Setting Provider</h4>
<p>Every setting has a unique name. Setting names are defined in <strong>
AppSettings</strong> class as constants. All settings and their default values are defined in <strong>AppSettingProvider</strong> class.</p>
<p>See
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Setting-Management">
setting documentation</a> to learn how to create and use settings.</p>
<h4>Navigation Provider</h4>
<p>Menus are automatically generated using definitions in <strong>
AppNavigationProvider</strong> class. We have two menus: <strong>Main</strong> 
(the main menu in the backend application) and <strong>FrontEnd</strong> (Main menu 
in front-end web site).</p>
<p>See <a href="http://www.aspnetboilerplate.com/Pages/Documents/Navigation">
navigation documentation</a> for more information.</p>
<h4>Caching And Redis Cache</h4>
<p>ASP.NET Zero uses <strong>in-memory</strong> caching but it's ready to use
<strong>Redis</strong> as cache server. If you want to enable it, 
just uncomment the following line in your <strong>WebModule</strong> (in App_Start folder in your 
.Web project):</p>
<pre lang="cs">Configuration.Caching.UseRedis<strong>()</strong>;</pre>
<p>Redis server should be running to be able to use it. See
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Caching">caching 
documentation</a> for more information.</p>
<h4>Background Jobs And HangFire</h4>
<p>ABP framework contains a <strong>background job system</strong> with a 
<strong>default</strong> background job 
manager. If you want to use <a href="http://hangfire.io/" target="_blank">Hangfire</a> as your background job manager, you can 
easily enable it.</p>
<p>First, uncomment these lines in <strong>WebModule</strong> (in App_Start folder in your .Web 
project):</p>
<pre lang="cs">Configuration.BackgroundJobs.UseHangfire(configuration =&gt;
{
    configuration.GlobalConfiguration.UseSqlServerStorage(Configuration.DefaultNameOrConnectionString);
});</pre>
<p>If you want to enable Hangfire dashboard, you can uncomment the following 
line in <strong>Startup.cs</strong> (in App_Start folder in your .Web project):</p>
<pre lang="cs">app.UseHangfireDashboard(...);</pre>
<p><strong>Note</strong>: Hangfire creates it's <strong>own tables</strong> in 
the database. See
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Background-Jobs-And-Workers">
background job</a> and
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Hangfire-Integration">
hangfire intergation</a> documents for more information.</p>
<h4>SignalR Integration</h4>
<p>SignalR is properly configured and integrated to the startup template. Real 
time notification and chat systems use it. You can direcly use SignalR in your 
applications.</p>
<p>Notice that; As the time being, SignalR
<a href="https://github.com/aspnet/Home/wiki/Roadmap#12">has not been released</a> 
for ASP.NET Core yet. We integrated <strong>OWIN</strong> to ASP.NET Core 
pipeline in order to use SignalR in the application.</p>
<p>See
<a href="http://www.aspnetboilerplate.com/Pages/Documents/SignalR-Integration">
SignalR integration</a> document for more information.</p>
<h4>Logging</h4>
<p>ASP.NET Zero uses <strong>Log4Net</strong> for logging 
as default. Configuration is defined in <strong>log4net.config</strong> file in 
the .Web project. It writes all logs to <strong>App_Data/Logs/Logs.txt</strong> folder of web site as default. When you publish your 
project, remember to configure <strong>write permission</strong> to Logs folder.</p>
<p>Check <a href="http://www.aspnetboilerplate.com/Pages/Documents/Logging">
logging documentation</a> to see how to inject ILogger and write logs.</p>
<h4>DTO Mappings</h4>
<p>ASP.NET Zero uses <a href="http://automapper.org/" target="_blank">AutoMapper</a> 
for DTO to Entity mappings (and other types of object-to-object mappings). We 
use <a href="https://www.nuget.org/packages/Abp.AutoMapper" target="_blank">Abp.AutoMapper</a> library that makes usage of AutoMapper simpler and 
declarative.</p>
<p>See the DTO class that is used to transfer a tenant editing information:</p>
<pre lang="cs"><strong>[AutoMap(typeof (Tenant))]
</strong>public class TenantEditDto : EntityDto
{
    [Required]
    [StringLength(Tenant.MaxTenancyNameLength)]
    public string TenancyName { get; set; }

    [Required]
    [StringLength(Tenant.MaxNameLength)]
    public string Name { get; set; }

    public bool IsActive { get; set; }
}</pre>
<p>Here, <strong>AutoMap</strong> attribute automatically creates mapping between 
<strong>TenantEditDto</strong> 
and <strong>Tenant</strong> classes. Then we can automatically convert a Tenant object to 
TenantEditDto (and vice verse) object as shown below:</p>
<pre lang="cs">[AbpAuthorize(AppPermissions.Pages_Tenants_Edit)]
public async Task&lt;TenantEditDto&gt; GetTenantForEdit(EntityRequestInput input)
{
    return (await TenantManager.GetByIdAsync(input.Id)).<strong>MapTo</strong>&lt;TenantEditDto&gt;();
}</pre>
<p><strong>MapTo</strong> method does mapping.</p>
<h5>Custom Object Mappings</h5>
<p>Attribute based mapping may not be sufficient in some cases. If you need to 
directly use Automapper API to configure your mappings, you should do it in
<strong>CustomDtoMapper</strong> class.</p>
<p>See <a href="http://www.aspnetboilerplate.com/Pages/Documents/Data-Transfer-Objects">
Data Transfer Objects documentation</a> for more information on DTOs.</p>
<h4>Sending Emails</h4>
<p>ASP.NET Zero sends emails to users in some cases (like forgot password and 
email confirmation). Email template is defined in <strong>Emailing/EmailTemplates</strong> 
folder of .Core project (<strong>default.html</strong>). You can change 
default email template by editing this file.</p>
<p> <strong>Email sending</strong> is disabled in DEBUG 
mode. Because, development environment may not be configured properly to send 
emails. You can enable it if you want. It's enabled in RELEASE mode. Check <em>
YourProjectName</em>CoreModule class's PreInitialize method to change it if you 
like.</p>
<h4>BinaryObjectManager</h4>
<p>User <strong>profile pictures</strong> are stored in database, instead of 
file system. But it's not stored in Users table for performance reasons (Users 
are frequently retrieved from database, but profile pictures are rarely needed).</p>
<p>A general-purpose binary saving mechanism built in ASP.NET Zero. <strong>
BinaryObject</strong> entity can be used to save any type of binary objects 
(byte arrays). Since a profile picture can be converted to a byte array, user 
profile pictures are saved here.</p>
<p><strong>IBinaryObjectManager</strong> interface defines methods to save, get 
and delete binary objects. <strong>DbBinaryObjectManager</strong> implementes it 
to save binary object in database. For example, <strong>ProfileController</strong> 
uses IBinaryObjectManager to get current user's profile picture from database.</p>
<p>You can create a different implementation of <strong>IBinaryObjectManager</strong> 
interface to store files in another destination.</p>
<h4>Soft Deletes</h4>
<p>It's common to use the <strong>soft-delete</strong> pattern which is used to not delete an entity from database but only mark it as 'deleted'.
So, if an entity is soft-deleted, it should not be accidently retrieved into the application.&nbsp;ABP's
<strong>data filters</strong> make this automatically.</p>
<p>In ASP.NET Zero, most entities are soft-deleted. See ABP's
<a href="http://www.aspnetboilerplate.com/Pages/Documents/Data-Filters">data 
filter documentation</a> for more information about this topic.</p>
<h4>Bundling, Minifying and Compiling</h4>
<p>ASP.NET Zero uses
<a href="https://visualstudiogallery.msdn.microsoft.com/9ec27da7-e24b-4d56-8064-fd7e88ac1c40" target="_blank">
Bundler &amp; Minifier Visual Studio extension</a> for bundling &amp; minifying script and style files. 
It should be installed in your Visual Studio. <strong>bundleconfig.json</strong> 
file defines all bundling configuration.</p>
<p>ASP.NET Zero also uses
<a href="https://visualstudiogallery.msdn.microsoft.com/3b329021-cd7a-4a01-86fc-714c2d05bb6c" target="_blank">
Web Compiler Visual Studio extension</a> for compiling
<a href="http://lesscss.org/" target="_blank">LESS</a> files to CSS files. This 
extension also should be installed in your Visual Studio. <strong>
compilerconfig.json</strong> defines all compiling configuration.</p>
<p>See documentation of these extensions to learn to use them.</p>
<h4>Base Classes</h4>
<p>There are some useful base classes used in the application:</p>
<ul>
	<li>PhoneBook<strong>AppServiceBase</strong> can be used as a base class for 
	all <strong>application services</strong>.</li>
	<li>PhoneBook<strong>DomainServiceBase</strong> can be used as a base class 
	for <strong>domain services</strong>.</li>
	<li>PhoneBook<strong>ControllerBase</strong> 
	can be used as a base class for ASP.NET Core <strong>MVC Controllers</strong>.</li>
	<li>PhoneBook<strong>RazorPage</strong> 
	can be used as a base class for ASP.NET <strong>MVC Views</strong>. 
	Actually, all views are automatically inherit this since it's defined in 
	<strong>_ViewImports.cshtml</strong> files. You can add some common properties/methods here to use 
	in all views.</li>
	<li>PhoneBook<strong>ServiceBase</strong> can be used as a base class for 
	other service-like classes. UserEmailer class inherits it, for instance.</li>
	<li>PhoneBook<strong>RepositoryBase</strong> can be used as a base class for 
	<a href="http://aspnetboilerplate.com/Pages/Documents/EntityFramework-Integration#DocCustomRepositoryMethods">
	custom repository</a> implementations.</li>
</ul>
<p>It's strongly recommended to inherit one of these classes upon your needs 
since they really make Logging, Localization, Authorization... easier.</p>
<h4>CSRF/XSRF Protection</h4>
<p>ABP framework simplifies and automates CSRF protection as much as possible. AspNet Zero template comes with pre-configured and working out of the box. For more information please see ABP's 
<a href="http://aspnetboilerplate.com/Pages/Documents/XSRF-CSRF-Protection#aspnet-core">XSRF-CSRF-Protection documentation</a></p>
<h4>Versioning</h4>
<p><strong>AppVersionHelper</strong> class is used to define <strong>current version</strong> 
of the application in single place. Version and release date 
automatically shown bottom left corner in the backend application pages. This helps us 
to see running application version always.</p>
<h3>Token Based Authentication</h3>
<p>AspNet Zero uses cookie based authentication for browsers. However, if you 
want to consume MVC APIs or application services (those are exposed via MVC API) from a mobile 
or 3rd party application, you probably want a token based 
authentication mechanism. ASP.NET Zero includes a simple JWT bearer token authentication 
implementation.</p>
<p>Here, <strong>Postman</strong> (chrome extension) will be used to demonstrate 
requests and responses.</p>
<h4>Authentication</h4>
<p>Just send a <strong>POST</strong> request to <strong>
http://localhost:62114/jwt-token/authenticate</strong> with <strong>
Context-Type="application/x-www-form-urlencoded"</strong> as shown below:</p>
<p>
<img class="img-thumbnail" alt="Token auth using postman" height="695" src="images/postman-authenticate-core.png" width="698" /></p>
<p>We sent a form values <strong>tenancyName</strong>,
<strong>usernameOrEmailAddress </strong>and <strong>password</strong>. 
tenancyName is not used to authenticate as a <strong>host</strong> user. As seen 
above, <strong>result</strong> property of returning JSON contains the token and 
expire time (which is 24 hours by default and can be configured). We 
can save it and use for next requests.</p>
<h4>Use API</h4>
<p>After authenticate and get the token, we can use it to call any <strong>authorized</strong> 
actions. All <strong>application services </strong>are available to be used remotely. For 
example, we can use the <strong>User service</strong> to get a <strong>list of 
users</strong>:</p>
<p>
<img class="img-thumbnail" alt="Postman get users" height="800" src="images/postman-getusers-core.png" width="760" /></p>
<p>Just made a <strong>POST</strong> request to <strong>
http://localhost:6234/api/services/app/user/GetUsers</strong> with <strong>
Content-Type="application/json"</strong> and <strong>Authorization="Bearer <em>
your-</em></strong><em><strong>auth-token</strong></em><strong>"</strong>. 
Request body was just empty <strong>{}</strong>. Surely, request and response 
body will be different for different APIs.</p>
<p>Note that we also added X-Requested-With header to indicate that this is an 
AJAX request. Thus, ASP.NET Core can better handle the request and return 
appropriate return values on success and error cases.</p>
<p>Almost all operations available on UI also available as API and can be consumed easily 
as shown here.</p>
<h3>Swagger UI</h3>
<p><a href="http://swagger.io/swagger-ui/" target="_blank">Swagger UI</a> is 
<strong>integrated</strong> to ASP.NET Zero but <strong>disabled by default</strong>. Swagger UI configuration is located in
<b>S</b><span class="auto-style3">tartup</span> class in the <strong>.Web</strong> project. 
You can enable it by just uncommenting the related lines:</p>
<p>In Startup.<strong>ConfigureServices</strong> method, enable the following line:</p>
<pre lang="cs">services.AddSwaggerGen();</pre>
<p>And in Startup.Configure method, enable the following lines:</p>
<pre lang="cs">app.UseSwagger();
app.UseSwaggerUi();</pre>
<p>You can browse <strong>swagger ui</strong> with this URL: "/<strong>swagger/ui</strong>". </p>
<p>
<img alt="Swagger UI" height="753" src="images/swagger-ui-core.png" width="974" /></p>
<p>
Thus, anyone (or any application) can explore, test and use the API easily.</p>
<h3>Unit Testing</h3>
<p>ASP.NET Zero startup project contains <strong>unit</strong> and <strong>integration</strong> tests. Tests are developed using following tools:</p>
<ul>
	<li><a href="http://xunit.github.io/" target="_blank">xUnit</a> as testing 
	framework.</li>
	<li><a href="https://github.com/shouldly/shouldly" target="_blank">Shouldly</a> 
	as assertion library.</li>
	<li><a href="https://github.com/tamasflamich/effort" target="_blank">Effort</a> 
	for mocking entity framework and database.</li>
	<li><a href="http://www.nuget.org/packages/Abp.TestBase">Abp.TestBase</a> to 
	simplify integration testing for ABP based applications.</li>
</ul>
<p>Tests cover <strong>Domain </strong>(core) and <strong>Application</strong> 
layers of the project. Open Test Explorer (Test\Windows\Test Explorer in VS main 
menu) to run unit tests:</p>
<div class="bs-callout bs-callout-warning">
A new setting named <strong>MultiTenancyEnabled </strong>is introduced for unit test project with AspNet Zero v2.2. If you disable multi tenancy in your Core module, you also need to change this setting's value to false in unit test project's appsettings.json.
In this way, test related to multi tenancy will not be executed. Because some unit tests (tenant creation, edition creation etc.) are only valid in multi tenancy concept.
</div>

<p>
<img class="img-thumbnail" alt="Some unit tests" height="244" src="images/unit-tests.png" width="555" /></p>
<p>These unit tests will be a guide to understand the code. Also, they can be a 
model while writing your own unit tests for your application's functionalities.</p>
<p>All unit test classes (actually they are integration tests since they work 
integrated to ABP, EntityFramework, AutoMapper and other libraries used up to 
application layer) are derived from <strong>AppTestBase</strong>. It initializes ABP 
system, mocks database using Effort, creates initial test data and logins to the 
application for each tests. It also provides some useful common methods for all 
tests.</p>
<p>Here, a sample unit test in the application:</p>
<pre lang="cs">public class UserAppService_Delete_Tests : UserAppServiceTestBase
{
    [Fact]
    public async Task Should_Delete_User()
    {
        //Arrange
        CreateTestUsers();

        var user = await GetUserByUserNameOrNullAsync(&quot;artdent&quot;);
        user.ShouldNotBe(null);

        //Act
        await UserAppService.DeleteUser(new IdInput&lt;long&gt;(user.Id));

        //Assert
        user = await GetUserByUserNameOrNullAsync(&quot;artdent&quot;);
        user.IsDeleted.ShouldBe(true);
    }
}</pre>
<p>It creates some users to test and then verifies there is a user named 
"artdent". Then it calls <strong>DeleteUser</strong> method of the <strong>user 
application service</strong> (which is being tested). Finally, checks if user is 
deleted. Here, User is a Soft Delete entity, so it's <strong>IsDeleted</strong>  
property must be true if it's deleted.</p>

<p>You can read
<a href="http://www.codeproject.com/Articles/871786/Unit-testing-in-Csharp-using-xUnit-Entity-Framewor">
this article</a> to understand unit testing better.</p>
<h3>Publish To IIS</h3>
<p>If you want to publish your solution to IIS, then check Microsoft's
<a href="https://docs.microsoft.com/en-us/aspnet/core/publishing/iis" target="_blank">
documentation</a>.</p>

<h3>Used Library &amp; Frameworks</h3>
<p>Many open source frameworks and libraries are used to build ASP.NET Zero 
project. Here, a list of all libraries.</p>
<ul>
	<li>Server side<ul>
		<li><a target="_blank" href="http://aspnetboilerplate.com">ASP.NET Boilerplate Framework &amp; Module-Zero</a></li>
		<li><a href="https://docs.asp.net" target="_blank">ASP.NET Core</a></li>
		<li><a target="_blank" href="http://www.asp.net/identity">ASP.NET Identity (and social login extensions)</a></li>
		<li>
		<a href="http://www.asp.net/signalr" target="_blank">SignalR</a></li>
		<li><a target="_blank" href="http://www.asp.net/entity-framework">EntityFramework</a></li>
		<li><a target="_blank" href="https://github.com/jcachat/EntityFramework.DynamicFilters">EntityFramework.DynamicFilters</a></li>
		<li><a target="_blank" href="http://www.castleproject.org/projects/windsor/">Castle Windsor</a></li>
		<li><a target="_blank" href="http://automapper.org/">AutoMapper</a></li>
		<li><a href="http://hangfire.io/" target="_blank">HangFire</a></li>
		<li><a target="_blank" href="https://logging.apache.org/log4net/">Log4Net</a></li>
		<li><a href="https://github.com/PaulMiami/reCAPTCHA" target="_blank">PaulMiami reCAPTCHA</a></li>
		<li><a href="https://xunit.github.io/" target="_blank">xUnit</a></li>
		<li><a href="https://github.com/domaindrivendev/Ahoy" target="_blank">
		Swashbuckle</a></li>
		<li>
		<a href="https://github.com/StackExchange/StackExchange.Redis" target="_blank">
		StackExchange.Redis</a></li>
		<li><a href="http://icsharpcode.github.io/SharpZipLib/" target="_blank">
		SharpZipLib</a></li>
		<li>
		<a href="https://github.com/kahanu/System.Linq.Dynamic" target="_blank">
		System.Linq.Dynamic</a></li>
		<li><a href="http://epplus.codeplex.com/" target="_blank">EPPlus</a></li>
	</ul>
	</li>
	<li>Client side<ul>
		<li><a href="http://keenthemes.com/metronic-theme/" target="_blank">Metronic Theme</a></li>
		<li><a target="_blank" href="http://getbootstrap.com/">Twitter Bootstrap</a></li>
		<li><a target="_blank" href="https://github.com/CWSpear/bootstrap-hover-dropdown">Bootstrap Hover Dropdown</a></li>
		<li><a target="_blank" href="https://github.com/dangrossman/bootstrap-daterangepicker">Bootstrap Date Range Picker</a></li>
		<li><a target="_blank" href="http://www.bootstrap-switch.org/">Bootstrap Switch</a></li>
		<li>
		<a href="http://silviomoreto.github.io/bootstrap-select" target="_blank">Bootstrap 
		Select</a></li>
		<li><a target="_blank" href="http://jquery.com/">jQuery</a></li>
		<li><a target="_blank" href="http://jqueryui.com/">jQuery UI</a></li>
		<li><a target="_blank" href="http://malsup.com/jquery/block/">jQuery BlockUI</a></li>
		<li><a target="_blank" href="http://rocha.la/jQuery-slimScroll">jQuery Slimscroll</a></li>
		<li><a target="_blank" href="http://omnipotent.net/jquery.sparkline/">jQuery Sparkline</a></li>
		<li><a target="_blank" href="https://github.com/pixelmatrix/uniform">jQuery Uniform</a></li>
		<li><a target="_blank" href="http://jqueryvalidation.org/">jQuery Validation</a></li>
		<li><a target="_blank" href="http://jtable.org/">jQuery jTable</a></li>
		<li><a target="_blank" href="http://malsup.com/jquery/form/">jQuery Ajax Forms</a></li>
		<li><a href="https://github.com/rmm5t/jquery-timeago" target="_blank">
		jQuery Timeago</a></li>
		<li>
		<a href="https://github.com/douglascrockford/JSON-js" target="_blank">
		Json2</a></li>
		<li><a href="https://github.com/tapmodo/Jcrop" target="_blank">Jcrop</a></li>
		<li>
		<a href="https://github.com/localForage/localForage" target="_blank">
		LocalForage</a></li>
		<li><a href="https://github.com/js-cookie/js-cookie" target="_blank">Js 
		Cookie</a></li>
		<li><a target="_blank" href="http://momentjs.com/">Moment.js</a></li>
		<li><a href="http://momentjs.com/timezone/" target="_blank">Moment.js 
		Timezone</a></li>
		<li><a href="https://github.com/janl/mustache.js" target="_blank">
		Mustache.js</a></li>
		<li><a target="_blank" href="http://underscorejs.org/">Underscore.js</a></li>
		<li><a target="_blank" href="https://www.jstree.com/">JsTree</a></li>
		<li><a target="_blank" href="http://morrisjs.github.io/morris.js/">Morris</a></li>
		<li><a target="_blank" href="https://github.com/scottjehl/Respond">Respondjs</a></li>
		<li><a target="_blank" href="http://fontawesome.io/">Font-Awesome</a></li>
		<li><a href="http://www.famfamfam.com/lab/icons/flags/" target="_blank">
		Famfamfam flags</a></li>
		<li><a target="_blank" href="http://thesabbir.github.io/simple-line-icons/">Simple Line Icons</a></li>
		<li><a target="_blank" href="http://fgnass.github.io/spin.js/">SpinJs</a></li>
		<li><a target="_blank" href="http://t4t5.github.io/sweetalert/">SweetAlert</a></li>
		<li><a target="_blank" href="http://codeseven.github.io/toastr/">Toastr</a></li>
	</ul>
	</li>
</ul>

</body>

</html>
